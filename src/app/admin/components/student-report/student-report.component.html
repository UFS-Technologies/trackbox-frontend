<div class="p-4">
    <!-- Filters Section -->
    <section class="bg-white p-6 rounded-lg shadow-sm mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 items-start">
            <!-- Course Filter -->
            <form class="w-full">
                <mat-form-field class="w-full">
                    <mat-label>Course</mat-label>
                    <input #Course
                           type="text"
                           placeholder="Pick one"
                           matInput
                           [formControl]="selectedCourse"
                           [matAutocomplete]="auto"
                           (input)="filter('course')"
                           (focus)="filter('course')">
                    <mat-autocomplete [displayWith]="displayFn" #auto="matAutocomplete"> 
                        <mat-option *ngFor="let option of coursefilteredOptions" [value]="option">
                            {{option['Course_Name']}}
                        </mat-option>
                    </mat-autocomplete>
                </mat-form-field>
            </form>

            <!-- Student Filter -->
            <form class="w-full">
                <mat-form-field class="w-full">
                    <mat-label>Student</mat-label>
                    <input #Student
                           type="text"
                           placeholder="Pick one"
                           matInput
                           [formControl]="selectedStudent"
                           [matAutocomplete]="auto2"
                           (input)="filter('student')"
                           (focus)="filter('student')">
                    <mat-autocomplete  
                                      #auto2="matAutocomplete" 
                                      
                                      [displayWith]="displayFn">
                        @for (option of studentfilteredOptions; track option) {
                            <mat-option [value]="option">{{option['First_Name']}}</mat-option>
                        }
                    </mat-autocomplete>
                </mat-form-field>
            </form>

            <!-- Batch Filter -->
            <form class="w-full">
                <mat-form-field class="w-full">
                    <mat-label>Batch</mat-label>
                    <input #Batch
                           type="text"
                           placeholder="Pick one"
                           matInput
                           [formControl]="selectedBatch"
                           [matAutocomplete]="auto3"
                           (input)="filter('batch')"
                           (focus)="filter('batch')">
                    <mat-autocomplete  
                                        [displayWith]="displayFn" #auto3="matAutocomplete"> 
                        <mat-option *ngFor="let option of bacthfilteredOptions" [value]="option">{{option['Batch_Name']}}</mat-option>
                    </mat-autocomplete>
                </mat-form-field>
            </form>

            <!-- Date Filters -->
            <mat-form-field class="w-full">
                <mat-label>Choose From date</mat-label>
                <input matInput  [formControl]="fromDate" [matDatepicker]="picker">
                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

            <mat-form-field class="w-full">
                <mat-label>Choose To date</mat-label>
                <input matInput [formControl]="toDate"  [matDatepicker]="picker2">
                <mat-datepicker-toggle matIconSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-end gap-3 mt-4">
            <button (click)="fetchReportData()" 
                    mat-raised-button 
                    class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                <mat-icon class="mr-2">search</mat-icon>
                Search
            </button>
            
            <button (click)="clearFilters()" 
                    mat-raised-button 
                    class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">
                <mat-icon class="mr-2">clear</mat-icon>
                Clear
            </button>
        </div>
    </section>

    <!-- Table Section -->
    <div class="relative overflow-x-auto shadow-md sm:rounded-lg">
        <table class="w-full text-sm text-left text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                <tr>
                    <th *ngFor="let column of displayedColumns" 
                        class="px-6 py-3 font-semibold tracking-wider">
                        {{column.replace('_', ' ')}}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let row of tableData" 
                    class="bg-white border-b hover:bg-gray-50 transition duration-150">
                    <td *ngFor="let column of displayedColumns" 
                        class="px-6 py-4 whitespace-nowrap">
                        {{row[column]}}
                    </td>
                </tr>
                <tr *ngIf="!tableData?.length">
                    <td [attr.colspan]="displayedColumns.length" 
                        class="px-6 py-4 text-center text-gray-500">
                        No data available
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="flex items-center justify-between p-4 bg-white border-t">
        <div class="flex items-center space-x-2">
            <label class="text-sm text-gray-600">Items per page:</label>
            <select [(ngModel)]="pageSize" 
                    (change)="onPageChange({pageIndex: currentPage - 1, pageSize: pageSize})"
                    class="border rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option [value]="25">25</option>
                <option [value]="50">50</option>
                <option [value]="75">75</option>
                <option [value]="100">100</option>
            </select>
        </div>
        
        <div class="flex items-center space-x-4">
            <button (click)="onPageChange({pageIndex: currentPage - 2, pageSize: pageSize})"
                    [disabled]="currentPage === 1"
                    class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed">
                Previous
            </button>
            <span class="text-sm text-gray-700">
                Page {{ currentPage }} of {{ Math.ceil(totalRecords / pageSize) }}
            </span>
            <button (click)="onPageChange({pageIndex: currentPage, pageSize: pageSize})"
                    [disabled]="currentPage >= Math.ceil(totalRecords / pageSize)"
                    class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed">
                Next
            </button>
        </div>
    </div>

    <!-- Total Duration -->
    <div class="p-4 text-right">
        <span class="text-sm font-medium text-gray-700">
            Total Duration: {{totalDuration}}
        </span>
    </div>
</div>
  